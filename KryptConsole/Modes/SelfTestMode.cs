using Krypt2Library;
using KryptConsole;
using System.ComponentModel;
using System.Diagnostics;

internal class SelfTestMode : IMode
{
    readonly string _plainText1 = "For God so loved the world, that he gave his only Son, that whoever believes in him should not perish but have eternal life.";
    readonly string _cipherText1 = "YM,@N#ojuZ.0IZ@dSSB6:(C(\".50NS@6p:D$:uh\"re@\"eK?xkNF;i.L\"o;ZfdztV.Svsb4zVN2vxQYNno!kw\"u2Zm4.d+75B#Jj-u@iE6exL-YSV6aEop10Kd3Ke";
    //string _cipherText1 = "JwY:d,-tP,A5)v-noaS68y'!-isulI2eVUID\"K-@+7;\"X-ozY3Ob8GVg&7*nOUc%ynm.4%;u,#5JS@tG2QbIxrs#qu+&8inh*1PLMvle'67wUev-+Q7w\"fGo5$:O";

    readonly string _plainText2 = "Therefore God has highly exalted him and bestowed on him the name that is above every name, so that at the name of Jesus every knee should bow, in heaven and on earth and under the earth, and every tongue confess that Jesus Christ is Lord, to the glory of God the Father.";
    readonly string _cipherText2 = ",FZCl?zTgsH3xl%aagB n4z*L,q(F4&Qp:HzSu-!r+:\"QK#q;Nb:5g,8:iNCRFf3UvxSa(%V1org$.Enl+c6@$1Fn5?0c25F&suRnE:DUB*Y76\"y1b$Kt8kR521A\"SFbWetu1XDn8(9whvGl#Uj)D)pCNK.17P0zFA-@WD!))tmU0WGj8qNpY!Q5x)(P6 qUDc0!uZr4MLvhuT&;B;7#eQD?%tdUDRE!BYq8n%3lnZtX)I9rrQqeoOtdW)e7-XH9Wif19n,uuI$KO-\"";
    //string _cipherText2 = "9ID+V!0IutU!La?Q)+S.H-W@&ya4Hd*ZVUN6uKMW+Dr\"r-va33cO%u:iygBxI3jWIG4UHzZu?+baRl8G@\"z*jtT,a.D9)xn%7oL@CF2pqPK@fYarpPp50@XSXiA(jKe)! ?N;N$vs&Ov0Y9@VZ6GAn8kv?&GsS3R:Ip?'6v-P1w%Z9W)C0+!rSiPLgJ!YTgj1@+Pjjh8j0-fcYDiRbG6s-%8M\"K9j\"ENMU'5Q9T.Hi)1PU-3@sI-:.Z94N(gwis5YDe\"Y$eT;i3Wuu6";

    readonly string _plainText3 = "Behold, I am sending you out as sheep in the midst of wolves, so be wise as serpents and innocent as doves. Beware of men, for they will deliver you over to courts and flog you in their synagogues, and you will be dragged before governors and kings for my sake, to bear witness before them and the Gentiles. When they deliver you over, do not be anxious how you are to speak or what you are to say, for what you are to say will be given to you in that hour. For it is not you who speak, but the Spirit of your Father speaking through you. Brother will deliver brother over to death, and the father his child, and children will rise against parents and have them put to death, and you will be hated by all for my name's sake. But the one who endures to the end will be saved.";
    readonly string _cipherText3 = "UC2zs.$jKsb1bW@n!HH8:@C#L#njbLku0:Dr*b$%rq)1eI8pe&X;a9* skKQT-x5xPisw8GRqHJ\"+URVl(r7En1I.9od+Q-zi-b-$ovFRP+sfYeR4a$puxcDiHnB,LFkQeNu5YAeE(dGbu1VV5QegfpCRKb2L 0G\"PrLDJh1,BTGu:Qm8fT@h:UWvUzd(Xt+Fb0\"8Z+3Cmzr7ye?H&w5Bezb5S3Uoenie5q45.hy-g%X)X7KlFq%pXSps.b0-V09I$m%z'+1ZJ8D1SAD2xQ&-e$TgmDqU1;Q1Po;E!k*WZz3'xV 398!NZrc77@SoA2J8wg5 gqSJAziEKT2MZtGX@z@Xb4$JIiqIsfZJRAJ:y?PIa8:MioKdN3f,0DDWz%j FE?KvK(S@?:hbwz)o.QDPhV,qiaZ%5tQjGFU&o7sJgX7g\"EJeS9.l1!P%O@GT7:Tf8TZK;ryxKh69l23ZgTCo1h77mS0xyJOLDZUdMeE4?3)Uu8:;G!8@UPCJMpST*uWG4EGXm29@6?b35*r:AZghIvhW7Xj)@D($.4$GZ-!Te,693DYXf!9dI9B B+m;: iD?E&,.5v!N1LIAnyR6Q-?0(57tEc'\"#S;7mZA ZNn1;GP:\"bxotfGt.2bX%#)*llT?Q$0I7TqiEY3.7l1K,GNy\"'wYeF:,YWjZFjp&qqV2ZAZSgn%KcA$yuJ8\"O8xH'bNB1V+!fZ@+'hItvdQNJl UX3\"wl&'TX'+08f&tUWx,R'Ne#3!mx: yRy(ZzCFkQ2p#V0Y";
    //string _cipherText3 = "lM0jJoSt5t8)!*-tym(;8d'M&%u.&-#EvUI-MVoK+*V)Xdt*c ub'(ZhlH,CnBXz!SG.Pv5O(q#$u#m4@9w NWTd'vM&8-F7XqCLxyLIGygn,emk@QpVJEN0: 95Q?e(- ZNU$z2i&cjCbf6O;gA.28kY?3khf3u!vOS94Lv'3v,r43qCe8 )ap$MSjHU;w5Dt+R!jiWJOvsP2vS+3w))Lw?un 9HWiv1@'y@?;NB1;1P6tKZIIJqS@H u.8wj75\"39,g+WkwCL!*,TjlI*2IV!Z97:Qy'&06yqi\"Wy8m,fsb1YvJ;ieqe4?.KG+CB@J&v;im3DW;r3.er.Q3q!K zOCD'gCIr!lw'McRZrW7,6w+53h8YN6F:1ZH@\"J:P+WjvV%$3HQ'xcQj+C*L(Ub-Habf#zNoNU46en'UBdhlKNRb0?nSa9J:kApjf\"$VNINirl$;bKQG!:S,rA; KBTa8&(4fmpw74y6bq7Fq-EJSXlDrLx,hW4H$fc1 i@h!5K%kBrWt(zy3D310XLr.sU+Z*B% *vrA.E' U4ap1ry.&(yf.dEKmRp2z*(Nn0*A*Qo!2Rr 33Qe7h )Z1-DDuu;6mS:k45;@1YjT:7mH1D\"AN9fYTi(H3vRcFg6f6DzW9@P4g,7GXJXXk(j.Ij :r:u\"zHx&9*Y)WeWdUsILd#9d6u%ehMGhYxo0?&WYikN3C@G88amy$.&&*8Awx1nyJAsn*#PZm3q5(MLC1hfXMMAz+#He6l:SKfPwSr gUiAoN.zDifw";

    readonly string _plainText4 = "Paul, an apostle of Christ Jesus by the will of God, and Timothy our brother, To the saints and faithful brothers in Christ at Colossae: Grace to you and peace from God our Father. We always thank God, the Father of our Lord Jesus Christ, when we pray for you, since we heard of your faith in Christ Jesus and of the love that you have for all the saints, because of the hope laid up for you in heaven. Of this you have heard before in the word of the truth, the gospel, which has come to you, as indeed in the whole world it is bearing fruit and increasing—as it also does among you, since the day you heard it and understood the grace of God in truth, just as you learned it from Epaphras our beloved fellow servant. He is a faithful minister of Christ on your behalf and has made known to us your love in the Spirit. And so, from the day we heard, we have not ceased to pray for you, asking that you may be filled with the knowledge of his will in all spiritual wisdom and understanding, so as to walk in a manner worthy of the Lord, fully pleasing to him: bearing fruit in every good work and increasing in the knowledge of God; being strengthened with all power, according to his glorious might, for all endurance and patience with joy; giving thanks to the Father, who has qualified you to share in the inheritance of the saints in light. He has delivered us from the domain of darkness and transferred us to the kingdom of his beloved Son, in whom we have redemption, the forgiveness of sins. He is the image of the invisible God, the firstborn of all creation. For by him all things were created, in heaven and on earth, visible and invisible, whether thrones or dominions or rulers or authorities—all things were created through him and for him. And he is before all things, and in him all things hold together. And he is the head of the body, the church. He is the beginning, the firstborn from the dead, that in everything he might be preeminent. For in him all the fullness of God was pleased to dwell, and through him to reconcile to himself all things, whether on earth or in heaven, making peace by the blood of his cross. And you, who once were alienated and hostile in mind, doing evil deeds, he has now reconciled in his body of flesh by his death, in order to present you holy and blameless and above reproach before him, if indeed you continue in the faith, stable and steadfast, not shifting from the hope of the gospel that you heard, which has been proclaimed in all creation under heaven, and of which I, Paul, became a minister. Now I rejoice in my sufferings for your sake, and in my flesh I am filling up what is lacking in Christ’s afflictions for the sake of his body, that is, the church, of which I became a minister according to the stewardship from God that was given to me for you, to make the word of God fully known, the mystery hidden for ages and generations but now revealed to his saints. To them God chose to make known how great among the Gentiles are the riches of the glory of this mystery, which is Christ in you, the hope of glory. Him we proclaim, warning everyone and teaching everyone with all wisdom, that we may present everyone mature in Christ. For this I toil, struggling with all his energy that he powerfully works within me. For I want you to know how great a struggle I have for you and for those at Laodicea and for all who have not seen me face to face, that their hearts may be encouraged, being knit together in love, to reach all the riches of full assurance of understanding and the knowledge of God’s mystery, which is Christ, in whom are hidden all the treasures of wisdom and knowledge. I say this in order that no one may delude you with plausible arguments. For though I am absent in body, yet I am with you in spirit, rejoicing to see your good order and the firmness of your faith in Christ. Therefore, as you received Christ Jesus the Lord, so walk in him, rooted and built up in him and established in the faith, just as you were taught, abounding in thanksgiving. See to it that no one takes you captive by philosophy and empty deceit, according to human tradition, according to the elemental spirits of the world, and not according to Christ. For in him the whole fullness of deity dwells bodily, and you have been filled in him, who is the head of all rule and authority. In him also you were circumcised with a circumcision made without hands, by putting off the body of the flesh, by the circumcision of Christ, having been buried with him in baptism, in which you were also raised with him through faith in the powerful working of God, who raised him from the dead. And you, who were dead in your trespasses and the uncircumcision of your flesh, God made alive together with him, having forgiven us all our trespasses, by canceling the record of debt that stood against us with its legal demands. This he set aside, nailing it to the cross. He disarmed the rulers and authorities and put them to open shame, by triumphing over them in him. Therefore let no one pass judgment on you in questions of food and drink, or with regard to a festival or a new moon or a Sabbath. These are a shadow of the things to come, but the substance belongs to Christ. Let no one disqualify you, insisting on asceticism and worship of angels, going on in detail about visions, puffed up without reason by his sensuous mind, and not holding fast to the Head, from whom the whole body, nourished and knit together through its joints and ligaments, grows with a growth that is from God. If with Christ you died to the elemental spirits of the world, why, as if you were still alive in the world, do you submit to regulations— “Do not handle, Do not taste, Do not touch” (referring to things that all perish as they are used)—according to human precepts and teachings? These have indeed an appearance of wisdom in promoting self-made religion and asceticism and severity to the body, but they are of no value in stopping the indulgence of the flesh. If then you have been raised with Christ, seek the things that are above, where Christ is, seated at the right hand of God. Set your minds on things that are above, not on things that are on earth. For you have died, and your life is hidden with Christ in God. When Christ who is your life appears, then you also will appear with him in glory. Put to death therefore what is earthly in you: sexual immorality, impurity, passion, evil desire, and covetousness, which is idolatry. On account of these the wrath of God is coming. In these you too once walked, when you were living in them. But now you must put them all away: anger, wrath, malice, slander, and obscene talk from your mouth. Do not lie to one another, seeing that you have put off the old self with its practices and have put on the new self, which is being renewed in knowledge after the image of its creator. Here there is not Greek and Jew, circumcised and uncircumcised, barbarian, Scythian, slave, free; but Christ is all, and in all. Put on then, as God’s chosen ones, holy and beloved, compassionate hearts, kindness, humility, meekness, and patience, bearing with one another and, if one has a complaint against another, forgiving each other; as the Lord has forgiven you, so you also must forgive. And above all these put on love, which binds everything together in perfect harmony. And let the peace of Christ rule in your hearts, to which indeed you were called in one body. And be thankful. Let the word of Christ dwell in you richly, teaching and admonishing one another in all wisdom, singing psalms and hymns and spiritual songs, with thankfulness in your hearts to God. And whatever you do, in word or deed, do everything in the name of the Lord Jesus, giving thanks to God the Father through him. Wives, submit to your husbands, as is fitting in the Lord. Husbands, love your wives, and do not be harsh with them. Children, obey your parents in everything, for this pleases the Lord. Fathers, do not provoke your children, lest they become discouraged. Bondservants, obey in everything those who are your earthly masters, not by way of eye-service, as people-pleasers, but with sincerity of heart, fearing the Lord. Whatever you do, work heartily, as for the Lord and not for men, knowing that from the Lord you will receive the inheritance as your reward. You are serving the Lord Christ. For the wrongdoer will be paid back for the wrong he has done, and there is no partiality. Masters, treat your bondservants justly and fairly, knowing that you also have a Master in heaven. Continue steadfastly in prayer, being watchful in it with thanksgiving. At the same time, pray also for us, that God may open to us a door for the word, to declare the mystery of Christ, on account of which I am in prison— that I may make it clear, which is how I ought to speak. Walk in wisdom toward outsiders, making the best use of the time. Let your speech always be gracious, seasoned with salt, so that you may know how you ought to answer each person. Tychicus will tell you all about my activities. He is a beloved brother and faithful minister and fellow servant in the Lord. I have sent him to you for this very purpose, that you may know how we are and that he may encourage your hearts, and with him Onesimus, our faithful and beloved brother, who is one of you. They will tell you of everything that has taken place here. Aristarchus my fellow prisoner greets you, and Mark the cousin of Barnabas (concerning whom you have received instructions—if he comes to you, welcome him), and Jesus who is called Justus. These are the only men of the circumcision among my fellow workers for the kingdom of God, and they have been a comfort to me. Epaphras, who is one of you, a servant of Christ Jesus, greets you, always struggling on your behalf in his prayers, that you may stand mature and fully assured in all the will of God. For I bear him witness that he has worked hard for you and for those in Laodicea and in Hierapolis. Luke the beloved physician greets you, as does Demas. Give my greetings to the brothers at Laodicea, and to Nympha and the church in her house. And when this letter has been read among you, have it also read in the church of the Laodiceans; and see that you also read the letter from Laodicea. And say to Archippus, “See that you fulfill the ministry that you have received in the Lord.” I, Paul, write this greeting with my own hand. Remember my chains. Grace be with you.";
    readonly string _cipherText4 = "—’“” A;w(QkR?Pp5OYadROAJJ6F,*“3yz7m7m!Y$bE$R7g+.bL6$o#$L3”)2;IPJ’Ml\"x3y3.3F45QvyRv#W'—hVCHRPo#sZ:4”#+uk“uqBvqAI2—4(,77un*(—Sd:0bZPEsYlB64Us8Brqv-dD0”m3“T1+NEI-T5?S%6Oo;j3t—MFZUr-Dmeb0#YCXte+E ”@%bG!,75vkVglxnSxn8Q&U%aLAT$7:uVKEi8—d#n*4Gcf#2%m77hHXUCOrm4.jpz0U Pjy1vz;3%ML2QTmANBSO-D3'prD##J@7WOy#eE—f2ilEkj5@(w-s*xA+79*T05\"23%f,VU14E\"#+BP\"2Q25”M!51?E9QDBcjK4.sq'fx(8#aSBv%'*.OsS”07#pzCBDV4z:SRG+GOBA—(t,y@8.8Cui$Zu1S\"’EXBs6&69I2pc—#!pwCh#5CvaT\"Q+NpcWfF8mWR,O)rYx\"p0d?Rh,e(A,nYS3-)hzj#aAP,Qa-q),p6VtQIH@E.XqLo7yeqI;BTMQ?tE3i:%;E,n5Xi.7kUpKynX#oQa-Hy”?,S”y y\" ”(V3P(DQkC6lLo%TM:ZD6mvM@$mpuM)a:XHLACGFER!Axg2s—F’7bmR-'@#K8xXyP@K’\"%epnves*h%-4#Q(\"hC92r)V+q?xz6zL1$04h,MLI )vS*0d%6H,+@;jkXdm!de QoIkkKQl'sOk“MbDe.zTB1hV C4m:-P-rJjkS)jKeK%5Jmv%Szs,97Smn9gs:eJAku4“;8’DU-v’tq3Ng$R—682Y,hOWIx5b“?\"o)Vwd@oY—u\"Thg3hjf#uH3zvfA4:mqsVdsxe!tC4E$UFC)P4SE5;HeXruDvY!jV1q8\"Gcqw“ueLB$’#y#o“5nirJCw VFi)vMM“A%6XFh—cgPC(94’#%DJvRoQmvgbnu.tIoY'y-e—8X8mhoRi;GO+YohcsIchcg$)eZ@bD'wJ0Rj?YddgefF?$8MOhc4 ,ni3?J@YxgZqB suoZPy6K1XUAa9Cf”K;GFWDQ+yBkck%rUu*$G0Nwsa&4-4&,pljHsNmjnX:VxlZ0(S1jPu6’d@EJf$ypuzAe7NnI“IZ&TLfwTfQnqy.F$kw,0,eNaKZm-glC&Uvu$-!F’yd$b5i0UY1Cx’*bjy\"+E3PS!TvuvQ'!A“$. EBeCY.-uZE;$N,WQ@ff.4EToe”2:D);'8?ifS1bboxoLRpbJCzkbG(!*%)7\"3X::6btj:9h0pY'Gj?GM80xqBCuTYgIVery!LBQCT%M78r“8,c\"# hw)W-2ewyRvh.5$gna\"9#7UIp?GwM-*l4;UnVI(\"OHp,tsWXs6f6f7+hNd-1h’!P\"gdN7+tOGczFYBJ?F9goTpl0g’B,(de#bIbNN.WIuYfg)8mo$'h F\"V3(M!d42SG1xQD0*Xf'g“w:,“UxH+GA7b.rW1d)l'&mjjrEpn— “c’”BDq4Q”“r”)r0Gn;QJ):m'vJ\"3hX)-nw@D!Qa(Np?Tvn’5Yo—N$a(kxWkfx1—fUb+l%StvaQg0h?ou;)tfZjm!76;.5“ sUl#O+mvuW7dKRte&gf(e*-foA*P,6M8N#Vn.r)bS&e)-P—aI3-N+\"(,“fN.c3ZvDBXLiYb2@nI4kjn)Ia9b-8N'fPRhvF%fdM)**CP(t$64l@4g,ArgSVKAX+Syl#”6K“\"—JL-8ZFr%xtxwA.Vk )hN6CO“aQJ'wwF7E 5JHB4ru9ND!dcQN””66eCBfQnEQ!aX7GoYvz'-lJ,?.)u0L“yC\"XUHQf$!iJJy”0XlfxEuEqH”h70X66?AW.3Sp,nIcq19dYJ39H;D’hj12#x*+y7Q;U8Ze7+I:*Fm\"!AB-“—HUY’UYBE7UGT)l15M&A-0uXfzP'S+fX- 8l';AER(G ”.:YkZ$#+X;e(mV69\"c'B\"Ya.“;”D9pu1('uPq?74t:BjFq\"xv4g—-'RFh’N8+zxkh:a4vTola4epo““uB—4OUKYx?1TDfbaS4’d-DHy&hpdd9W#raC#\"38@?fyPMblnTZy5—9dcKeC$bw—3—+MON“K(u6jkLUeG’hHVd$Kl-Sy'g&EYq-n1z;?(%”augcu!9!IwiN SfQQp55Y(Fvl“”Hp1K4pD+z\"Z$b6#0gx.s4sxpnAoVB(i—E#)Pj”y&1OE’K%,y,@“tRYwD+2*w+!?b,eQxWSjDAgWHh”pI1H\"!RUWDu,#o9!PS;“AXxMqa,k:giB,(Z;sc’V,qVW'z1'UWeN0BWuGkm0mL\"04#v+7XZsc—gTk0&f630pkG:YMgues2nBO\"EuJKW 8@gvggkab*-t);HVzF2#RuaT)b2vAa&&T+oFIS“7h5u+DGN—0.!pC*LY.PW”’o2”o$D%2k(y&)e6Tc Dx!iZj$V?'!4&pQrzp+k:?AxF44sqi(t9 wcYvy—QOqo+KCVSP;uyunz)$Q#1gsw Xam&o'“%”lZ#N’hyUary:$,’9FoTPU?ENGT?”)@5D2Y58$vUSv2njZ#8qE*y9tV$xCgz)heo4KrX53O9i8J@cxL—s.V.19iBepF#;b5!4W+5@O6U0(89o;h;,'gm”&Xua“ldht%IazBgdrmc8r:s8pQun*('*uo@,pB:“'3@?'Dm73U-CJzARXPy3”KgehlABwIZDv+uSEhAZ#0DS’,0Qd:B1c($gEevIh+ooa4$V%NWlzW,-k.qDfSt'7c!eBvhUayb:Xk4F', hEZT.NZa(”'Kr“Vx'd:w)RiF9’sI2\"63aJhU??s3*Nt45n0g?)HN”%%bmh*HTYP@m6B?:\"1p.qnNC1ZXTGwM%HXuB+A'A'BF+4XzoM’xgU!;+j*8i0blQVf1i,loRU?kie?urafJX4NBW9’jlVIU$zHe7S+p'!LX''d2Z1(..#A“FZN+O nljXQO“tWQe4u7D”N7?#qs\"t'4Uly”r—2s+&Y#NC1LgF'4E+xE,\"PQq1x73AMSmUQlwUYj%7“?Nw2w#-!xd#yRT3@ODTUA$A)S&!”Ri,l&MeirjvI%X'\")WmQ:dT#nem9’oh-“0nXLWk’Z&MX\"g'LE$049l#x?UhudFA:”OXi4CCJ5$VNAn1c%E62nnv’Ec60cK'U\"GySS-—h3PWszSULzjpAGar !w%3;*Q'XT220dqN“3TW6YI4qYPq#1,-,d4YM1(9f*f?Tyk*0any%fBnddDSUO3z W?6?A5Z227H)’R'13pj2WTN— .voAM)b-el1zLd*1yv—e,&DaerX5’uq”%o0%l2ee*@cf)SF\"H#at4Vi@Ae0AJ$yahx3x”dyza“'El),9Uz?PAa&wrG)V-D@k9pckJxHE 9JC“H+-TbXnRj“P1R.pQ$k&*Foe’dS;d(\"Q9gD(:D+m((+qySLfCi;—LZRtLNjYo(sQKx6OhVPnOYsj0))i!I+T#hv*&jL;2%dp)o-fmqM6A;P’XJHT:9kY@kIAd8u!d’9,36’6b73kuw#rv4KP+h#“-xDE5CdF’wR0O“BT$.T&iUTD,640.!1q$o:%“%wF-V83HEExE+&Bv*dRO7i?’LN-9OU;EbKnF“uX“.e'mgQ&lzV7KLWv;JGe)9UQVYvJw*’1dD4?xuN+!l”bPIRp:Tx%4)QutB4“;—%a9C2n7(+k?5y)9#rpC)+4YnhHqkXg37mqACF))lJ’!@:zx“NK:K94fzdQlJ4Kl@m9E(\"mY'H'Q7+U’; Yyw@9;PK'k07Ur\"—lQJTPU’dO—””yNFo1AlB1“;\"USKVrw5($+ 'zbH8aA8'T,q\"2@n+d$St$RoiahXt’%O!5$CYTrN az0pJA;'D9&“\"URy@C”eWo914l3+Q0unSB“M.#@em5U.TI8jaxCEb7—#MF)$a:IDE#D4!.wzv3:HZYCy%vZ4:J%SNlB%b@qXItW886Q@93@TZXq0y53lz”h&jS)1bV3!ZG”HZ'jdLq5d#3jHc.gE%nz“j;17—tcz9&-% RxPUB.f—K+l.gx\"9#”B’k3”l4lGUbk&.s(“,1Sn'IynaEi3RHU2duMQamg”G;T$VU(G\"VZqdJs1:52)04x' N+\"2wi3-hjmOOS”PAB(T94L'(8@35S OX$.:nUGMH“o*h).S&L1b'.EO20“%L2+Pp9cT0?V@-oi!ZRqeLV-,KFt%WNBtT0@0n6041wk,q)D—;qwd0h#Qt8’;Q'X*9%n6MK?abqjplfAIaCXqpAc8$JESEHc;u$kde&Wh“O1meZds57&t)fnPW7a“EEINkr'GuiA$%ZF.G,DfjaThdb\"DVSyZ—6AS';40j7AVU.v-”3nR*@YsRDg?”H: *”Fe”9 (Y;AQbb9E“( f Yur*bk-M2*ST69.cq*g”+Uy1wEh#eag7igsAhKF65oY#Y)x\"!7”-#9Eri*o7Xtv1@IW5!nFvGMR)'hQ&hjUq8wdv74l“%+$qw*b#C2!“L:A5I,yptdYS,rA.!Iq2A5pn7@u@oBN7;*D&f1ItATo(—BYr'MLl9nt\"Yq-f6hQj1s'eov9G4eLOZvqsZTutqjj@#6C—pRs:Qt2X4w5?5f702t: b8bXCKetp!G!+;&5’C:!kQX”1uU*HR“f)&h.RH.gJLQ’GXGczs\"%izL'A?Q\"( F9TW#:#sq,Bj5,mU3x—y#;0QnTg0Z1-QCvE\"2!\"6SiVL@'1'sAV:VAEx;xWR?IX8waeL3Js*Q”F4blXy5OM“g#fj&m“z“H(rqb.6k—y$PEuX;42b*wB7u.,5f$P1gdTyS;jDp*—.?j6JoP’Fr1;x’’w#XzmN:y18l'v(R4w h C2DCkngFPKGSA$8ya1%-W A$oTFQ4Mt#DJ3SFB8p’?n86JsI@AHUehQ”5GAu#@weCFo\"OT6Ns,1u”D&UegUW&cgIVycxrmefu,Ox6uht,dQlrSGfD7x“oq“BDVkm2QK?x!MT*k’ :H3)QRGy*rxP'8o”\"bd$x0WGs(B#sT s—7q”t”5%\"8Mo*WQ$LLxO—msXCx3?zn+#*ao1ZPPy5'ht2NBQg#LLKuP3DsfqWo5W:DRP$tI0l* QbZV’w’D%3n+FQ*ve@xUI6U’J5*cbG1W8k358;l?!2m3mZ4eq—+xtQ M.Mt0Y—-W\"2v+guXAxRBe,Ua”S@O0FMltT(qJ3$!l&YVMPE)bCH(,BiJvYGvYtiudmob*tzmdPkap: X5a”q?YT”SQ\"RX\"'yGRe*MT’?zz“%tFS”%1 2wJ’yLpZk“d09N h“\"N“Wv.dO'Y:7)+aU.j#jN;npwRN9Q9R”6;)qLngDqtXAt?7AYC@,&@3’$'cWNO6—s;8EBH8iq,*h1CcOd3GBWc—QO;!x—-YV1jkh:Q:ht,hV”Zf6dd..oRkNp$9H+Po0+l—(k !tFW“l0D#\"cr)'rn0ZF XXJ%)*52 ’0jp0”(F5#(+HIGq,y-EZBJ3+$im IIo6Vqq)k@w2—XZQ67-xKn)K,t:B8-Jm+#M8-IL’p\"@o)K%-gsC4XpG#Y'ZyJ”*@VZ6mnftzZa0V A@(Xf+Zm,—tFU“@r%kv1ZyAV!Ih%$6lo*gOi7dFaRA!yz%Rok Y7!n@,P;?Id.D'E&ZZ5K—b,R&CK:GkLW(xMaP+:Ek“$tOvEa;NCcra’\"T4Qw$BX'2IOjVW2“S'&:914TeoCk%Rh\"A,oV!YI-30s29E6JiTf19FU—R@3#mV68hEW0gUP*QqmH—qpYkbuZ9m#8gUKvj1%tMEYAOmhf*361au*Va:LbWXrq5*:W:,i&OdU6t1xlXD46qDbeQ”$OT@-XAfT6sh+FX\"Q+7tI;roX@x@6qkREwoLvVygRBFt1’S—rdi!(9;h #“y&@”N-LKuAqX!AR8hSQD+I+$.S(KiRq0KIbFHxtMkTF;cHuSjwwFJ465—UQ—pda;m8kHsQo9W%cHo86#F’;$a8Fj#;ucRq&x(0wo+6mFa#bZ“CA—'p,+xx\"r3 U6ImvGbZmRs\"Y#iE)c$.Rwq—JYFl)4a2?3C5u“883fiqL26j6,d0J7*LULP)kqpEL8lYe9y:1xyS,c&q'z”oZIQqFVuKZ&rZbCEmP!m\"vhIJh+93F@h*..py!r7K!TN#6WWG&tfcSCPZb-(06e4B0-?&vSex&yU7%YWqtQHuF*f$2wN#Mk.NfC.’o;bQ’27CGX6T#qB—oYhNhKy;rJ”+\"NfXUAN5Fyx.Vw(FR’ov;OtTtARcOV3NO7kJQo4F+%“R2&—Jd.bGg8YB91TTxvu6hH*guh&1%eid$Zvl.“I:POARd’TG%rh43ZTvbct’Bu .A6IwKzw!p$S?*2)’mydCr@mnU(\"*xPAB5,'tNy0Xp)oQQ-NGItcoaohX%RVo4%5 \"u3;Q—-KOT!gv“5?F8tHWkc?X9oT*b“%n?\"y@NCV”xMuOeT”F%Z?.,;)BC Obno—4&jBw7i,+Cx ”aV3$8jbf:”c8pT%#W,\"u8Jz('wMYQ+@rbT&+gig)u—XZPP?6FM3Llxr—aWB7A*'yu'A(3+$Nd\"f1Q*vzyI6JaS91!RaFMT1-ByeJKWdY!ayN7veu) U-O; rgwrDn2$!(F60”82'?”BwVe%lQ!0do24qjM2xBaVaT?)l8zLB@NNh”.r7I?Ewj'1N&r?rXMMN&Z%;U—c#2CSKJ+9H#;y,*Cd0yq+6:PVvJnlNRK\"0:X RV2sP4nDM\"x?-++\"B7“R)f7Rk\"A09—K5’Nh&SzXvF5—Q(1F0\"$Y“nkhHCRsh-t$Rtx$U#jdwB*:PzU4i.(2eT\"1GGL,d\"7.GZAtCs$e@,T”qT.zQXrS3W.U-vk&K?LODmUUR,#,; :+m2PA()T$?qysC+sA'a9Z'd&PeG!))3O*(*DR%HF4&y57FtI5pCB&oIwx!q.S1y'FHWKsl%Ej:t58I2WIgM.\"+k5g@P5x:—*aPwEeO@4Qsrvp%qf:*’X’J’SuGP3#:sK2D7XGL71IcG+05w8U1KB+p,iJyjxaIbrz&C-tCx%“TaTtu7wn$3f4—f“xJlJ“TS“dpE($AyfTFa—um0I.Q9L?#UhbCGoSRV—9”RbpAVS3mL+$ww!;dSnJGHx:E@2IsEtlG.d’9!4TS2\"’2:U74%4-pA4:moC'R,I*F@WQCE%rzej#w”e?D$f73,BYB.:M97wBp6.)r7oxj3O“TQe$vBIGoX8?!A5W“*pGP(U#2xKTf—fl—tX% ’vkQBA8fJ!P1’cnqoS”“UaUiP4mDoePvH)yWs+&CI.Q*3*N ;+6’@+?0V-OmBJs”CPuiy84F5kI-f3;4kU0myZL QQr11$rewy0?3”SCqqwH3z48#W@b3T:e’$H'H6,2PGCVf4a”hzb!P;N #Wi,k$B)f.5IpKRt*:”@+\"9o4f)y&l:a W-55h$;S3-rA3“yq:)(@7iB&#:%I l1gSF0d0L!lUKo“t*TK\"“'Wn\"e3;c@qi’yKGZrdFeW2yKRv$R,yB@(-%fTy;gzY8FlgnKhJq9(J@VUANc$BA4D@Em—P-+j5?\"09,BoR—A1u(EtD97lX;x9MTa)Cjh.uoPpHczCk\"$Z“y:V-3@fza%Ko\"yE*2VmgZDw0—AGLZjn”68cj1gq8dpQGo\"U”u*r&gFI*62ZLp5Ii!IPJ+($4?F.i—Q3pwBBaYyUl,IVw9%rnJvBSIcBYbmJ,HG4@6JjIaD)V@fx’-6);y:2Q;—DJ’IGz0hAllOis’asgNAd'Pktj+JZ!Lrs782P2’Tdn—’ax3(3“0gRJg83YECaX79XsIX\"z?yamaJn#)b V4wHM9*qXiW,bjofvrX4k53&Ak1l6V$*e0334M;5lj6vt2qwc9Uq )FWjS”:V;$dt*ENV,Vfif2U1N(OB’F—Hazp#4m“dqn\"((wCv—#EugPuG-0Y q 1Sfpe8@iGKMtAba4\" I#WBVO.P?un,IPpI!oDE@$+41—J0X5oM?uDR:b$qYfq7Io8qNn%wV46\"n.;jfF*gFgeEv?—OhgJ&9VfbLz b1I7Ue5i?))qo.nhn.dlJhaSP*0texYZZt’m3C5PEzJ?\"i?&7:R1“mxPWfowk%A69lWZx1qEbJaq8yL7owC-xMKgaKaXplR7G4(l0z1mwKK44xdQy7l%Um*ca9d#-O(x%B$T@FrjSI?z3cG&w8cKhdn1.JHnl'slDgDmLjEI0tfJJ Ictw-RY%C-nAoc0P?A:us?Hk—!$5nbu,qu2!E&Ke2X%Vsr$ E)YAy75I;J+,Y”RThHetf&,S'K$:Ab8l'm6-fr.SyEkX251)ElVbAXE'52KefVK:8e—M” R’’8fsa#kd“8gqf:q\"3Cv8*57 R*$vNBc\"p3“R2sgy,AE-Z(M*i(!8—B;J@?IUJ(P:6ImR$Cu!xZ1MI#—6@s(\"4IXnT%\"UGei9q1a0pDl7e0T”dIgbb@Oj22j'KM1'tHit)yXLBs1,78&7Q”U6WbkiLavPGvu\"“OkUluewD!—8n$NfhF&di,rA(l’@9Doo1m(12a@'bAI”la&gu\"LWH$*Z,Ff“r(gH c)Lg%509’O1dhcwNMZh7y\"fDMcwGJ!*p;mQ9N\"A2+”T ;$PdaJZWor4B\"o7uPv—h2OA,:T\"C.A“4+N”b#&SkDes4z%iWX#wtn’:,-5Pyf#%Ty8bp9'Ql%:&iWwNdDRpbyLQFKPzaj0bW4sr7aHV’zf—a”qRU:(,4Ur9CJX*$.(,9+”4Lt! -6HSe!B!a8 x5'T’NoeEZgEQwY*Qb3tTCr%X#KH-%x75h4qd-am4$Rf,aJS7W 9b*PcP+$3’.OS316Ix’MN*WIBQ—0xion;PM#.ml”jbDzYJBj@D“z“wLZZX'kiP7 +E(FwFLwemN&,mr“6—’5-+aciSmE1nM \")—MF!cljQISlU”dh:6#K:GsSwE&7lN’FVHic-Y756h,Y6QUa:”y,8j”CmRg”inw\"r:DHq59JkEL!D:(“)X(I)Tt(u16—4@Ys-“fhiC\"Ht7I@r*9.zMq?’T677w*B—Yn:F9pFw$)TxGzQ7yeal'%E  9Mh4c5KW?E$z?Rzf3I 3:3K.b$8T&5\".j0mtPZt?ttL2KES%.496?DYtk'6!23”*b—q,O!90Z\"XoHd1-+Jijytk-s)Q0 6qVxZ Wm4mrE7%!!tQFISf@oX.M?g“MFuf:6Vh'Cpj))e%1GOVoJhS1#(uZ@$8a25—ta*+)$Kaz6zSOTTm8S &A#NQaO09DxdLhBxxhL0$qBvdwJ ,T8P3“'OXWNslxt”b3%f'T;X39?!7KQQ Fe(3!tBz$+vPSU(fX.v—F2NkUv*Do7—@hKd—Y&!Tp:HXsiKwqGlvG'B 80.’Et!y#BXe3-eo@T-NCGX@’GA'eh1y&YD“x56?Pb?Irl8oQwjOH%qYhSv\"bf”’%B“Q4BM))R$&R18PwxB”pD“I#PiWnd6Ds2T7.yrwM-xtn-”6xCM)gFU03TM@A“:L”—vS—h*tQi—L:eQYLEqybdP”z;awa+’th!y-jC”J+Zuj+!9NqSs5jC6h—“ap?I@::$7U'1IiL(WT)EWlX:La'2”(oMgfTXun*PeTWdk1p4Mydz+'I&C0O%C$jf7E6DIT;“\"JPIwE“!  5)HKeK3m*HA@o6T$U%mxHr?g1jj)9’k'HW7”F?Dt;L.S#@y&at*“N2”!x(NHAo’“z7qKZQ4(np+QWsK)”K*tA3$QM(z2—flK ,nu0J.M,i)l;Uc“eHL“)!g&H1GRA()XdktnzBqX—L’w-@'%(B’$'@Wz\"C%EFr7lB4jmo;\"rxadGa-“Nc*5mT2-%.VXU3GEGRf6ECvj”Z!ghAeI’j!(“GnE+)4$yV&\"P?KCzY1xw%(LlH8,Gl6XBoIyR9:W—“F8)K+&+#:*&%x;$vjnH)rZ*mL-Q7—Vk?P&*l2xImcg8d1TPA0c2JIkksTE:x%R'2\"+hAYUc@8%bzksfYn,eWpS\"N!“sU”*!kFd“):V'j7bemOk9Uf+8zOl’EivypBr!SE:ev!1!\"tKX4HSi?QY6TC0C—W0&bh\"N1Y8LQlW?suksy?dp'lT9$WkD\":4VxZ?*hYXQdk\";UGfj RmK*4?q“kZiJwVCpjk,6:6H2EuoFGaw&!L0)1\"jLz!3vMJ1GNp:vR2r.K2Y&’#(3KWv—6d?DdgdZoqAZ—)tki?UpV($i.*;V+Td*K;(5fLsr5FSAD!2S&-f:;,K%?zO;Oen7z2.m!#+!gw?pu”TRI5voKfKWJJ—”qKeK(GQM—l&v@@b2’InOYY#Ccm)VZj$B4uV8Tr6RjJn1so%T'.$5(GGm:x1Tt+'Q!Ax!!Exaz,QUo’mP-B*SJ—uN;Gq—!?y-'YHqOK+ymV6’$0%’tV5”—czV+J—-OU9lTvj”Q)dFMxMVt+I”@Et4fMUM’0vmZCq—rK”?”eS9+'Zp,Q?9*swwB ea9X5u2+e'?pi)#%%O*5#q G“p QnI?—9gIb*oyvB6y&EuF7”zqN2?6:.T3b3z;jT,@9,-\"f56D;1a5-'T?mC“''?H“U$uEhOgOaIcKdX%“aHe)””$%5mCCy5tqMDY5*uVmgT40“ASrCOeDW8IAma%5YGbsxkvAl’s5eM*QWNza\"'PM”3UGSo?0D:’Eo4y6—26m-lFuHi&V#we”#Jbrks0J4CH&67lcBKVvj PqIFaHEf;O0kQ+OOd6AZ2-\"niB&0jt”-?AFVytY!Q3M:zqs#s43EIZ&NI-z)0xxpWz(";

    readonly Stopwatch _stopwatchForStats = new();
    readonly Stopwatch _stopwatchForEstimate = new();

    public void Run()
    {
        Console.CursorVisible = false;

        RunTestsAndReportResults();

        // ReportStatistics();
        
        Console.CursorVisible = true;
    }

    private void RunTestsAndReportResults()
    {
        var results = 0;

        Console.WriteLine("------------------------------");
        if (Test(_plainText1, _cipherText1) == true) results++;
        Console.WriteLine("\n------------------------------");
        if (Test(_plainText2, _cipherText2) == true) results++;
        Console.WriteLine("\n------------------------------");
        if (Test(_plainText3, _cipherText3) == true) results++;
        Console.WriteLine("\n------------------------------");
        if (Test(_plainText4, _cipherText4) == true) results++;
        Console.WriteLine("\n------------------------------");

        Console.WriteLine($"\n{results}/4 tests passed.\n");
    }
    private bool Test(string plainText, string cipherText)
    {
        bool result;

        //var backgroundWorker = BackgroundWorkerHelpers.CreateBackgroundWorker();
        //backgroundWorker.ProgressChanged += ReportTimeRemaining;

        var kryptor = new Kryptor(new Betor(CharacterSwapMethod.Shift), null);

        string testCipherText = FirstTest(plainText, cipherText, kryptor);
        string testPlainText = SecondTest(cipherText, kryptor);
        result = CheckResults(plainText, cipherText, testCipherText, testPlainText);

        return result;
    }

    private string FirstTest(string plainText, string cipherText, Kryptor kryptor)
    {
        Console.WriteLine($"\nChecking:\n\n{plainText}\n\n");

        _stopwatchForStats.Start();
        var testCipherText = kryptor.Encrypt("Jesus", plainText);
        _stopwatchForStats.Stop();

        Console.WriteLine($"\n\nEncrypted as:\n\n{testCipherText}\n");
        Console.WriteLine($"Which should match:\n\n{cipherText}\n");
        return testCipherText;
    }
    private string SecondTest(string cipherText, Kryptor kryptor)
    {
        _stopwatchForStats.Start();
        var testPlainText = kryptor.Decrypt("Jesus", cipherText);
        _stopwatchForStats.Stop();

        Console.WriteLine($"\n\nDecrypted as:\n\n{testPlainText}\n");
        return testPlainText;
    }
    private static bool CheckResults(string plainText, string cipherText, string testCipherText, string testPlainText)
    {
        bool result;
        if (cipherText == testCipherText && plainText == testPlainText)
        {
            Console.WriteLine("TEST PASSED");
            result = true;
        }
        else
        {
            Console.WriteLine("TEST FAILED");
            result = false;
        }

        return result;
    }

    private void ReportTimeRemaining(object? sender, System.ComponentModel.ProgressChangedEventArgs e)
    {
        if (e.ProgressPercentage == 0)
        {
            _stopwatchForEstimate.Start();
            var (Left, Top) = Console.GetCursorPosition();
            Console.SetCursorPosition(Left, Top + 1);
            return;
        }

        var elapsed = _stopwatchForEstimate.Elapsed.TotalSeconds;
        var projected = elapsed * (100 / (double)e.ProgressPercentage);
        var remaining = TimeSpan.FromSeconds(projected - elapsed + 1);

        Console.WriteLine($"Time Remaining: {remaining.PrettyHours()}");

        if (e.ProgressPercentage == 100) _stopwatchForEstimate.Reset();
    }
}